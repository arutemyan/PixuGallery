# PHP実行を完全に防止（セキュリティ対策）

# PHPエンジンをオフにする
<IfModule mod_php5.c>
    php_flag engine off
</IfModule>
<IfModule mod_php7.c>
    php_flag engine off
</IfModule>
<IfModule mod_php.c>
    php_flag engine off
</IfModule>

# すべてのPHP関連ファイルへのアクセスを拒否
<FilesMatch "\.(php|phtml|php3|php4|php5|php7|phps|pht|phar)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# .htaccessファイルへのアクセスを拒否
<Files ".htaccess">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</Files>

# 実行可能ファイルへのアクセスを拒否
<FilesMatch "\.(sh|exe|bat|cmd|com|cgi|pl|py)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# 画像ファイルのみ許可（ホワイトリスト方式）
<FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
</FilesMatch>

# ディレクトリリスティングを無効化
Options -Indexes

# MIMEタイプを適切に設定
<IfModule mod_mime.c>
    AddType image/jpeg .jpg .jpeg
    AddType image/png .png
    AddType image/gif .gif
    AddType image/webp .webp
    AddType image/svg+xml .svg
    AddType image/x-icon .ico
</IfModule>
